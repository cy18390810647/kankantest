<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>夜间值班流程图</title>
    <script src="${STATIC_URL}assets/vue-2.5.21/vue.development.js"></script>
    <!-- 生产环境版本，优化了尺寸和速度 功能完善后请将vue.development.js该为vue.js-->
    <!--<script src="${STATIC_URL}assets/vue-2.5.21/vue.js"></script>-->
    <!-- vue的ajax依赖-->
    <script src="${STATIC_URL}assets/vue-2.5.21/axios.min.js"></script>
    <!-- element UI引入样式 -->
    <link href="${STATIC_URL}assets/element-2.4.11/index.css" rel="stylesheet">
    <!-- element UI引入组件库 -->
    <script src="${STATIC_URL}assets/element-2.4.11/index.js"></script>
    <script src='${STATIC_URL}js/jquery.min.js'></script>
    <script src='${STATIC_URL}js/jquery-ui.js'></script>
    <!--jQuery库使用时请使用标准jQuery语法-->
    <!--<script src="${STATIC_URL}assets/jquery/jquery-3.1.1.min.js"></script>-->
    <!--页面初始化css(Tencent)-->
    <link href="${STATIC_URL}css/init.css" rel="stylesheet">
    <!-- 引入额外的包-->
    <link href="${STATIC_URL}css/nightThird.css" rel="stylesheet">
</head>



<body style="background: rgb(246,246,246);overflow-y: hidden;">
<div style="position:relative" class="dutyback" id="nightThird">
    <span
      style="color:#00e4f4;font-size:18px;display:block;position:absolute;top:30px;right:20px;height:25px;line-height:25px"
    >{{date}}&nbsp;&nbsp;{{time}}</span>
    <ul :class="[myclass[0]]" >
      <li>{{mytime[0]}}</li>
      <li>{{date}}第三方<br/>存管数据处理完毕！<br/>投标系统处理正常</li>
      <li>{{result[0]}}</li>
    </ul>
     <ul :class="[myclass[1]]" >
      <li>{{mytime[1]}}</li>
      <li>集中交易系统初始化前<br/>通知资产管理公司</li>
      <li>{{result[1]}}</li>
    </ul>
   <ul :class="[myclass[2]]" >
      <li>{{mytime[2]}}</li>
      <li>公募基金系统初始化前<br/>流水归档</li>
      <li>{{result[2]}}</li>
    </ul>
    <ul :class="[myclass[3]]" >
      <li>{{mytime[3]}}</li>
      <li>公募基金系统初始化前<br/>备份</li>
      <li>{{result[3]}}</li>
    </ul>
    <ul :class="[myclass[4]]" >
      <li>{{mytime[4]}}</li>
      <li>多金清算公募基金系统<br/>初始化(T+1日)</li>
      <li>{{result[4]}}</li>
    </ul>
    <ul :class="[myclass[5]]" >
      <li>{{mytime[5]}}</li>
      <li>公募基金初始化后<br/>核心导出</li>
      <li>{{result[5]}}</li>
    </ul>

    <ul :class="[myclass[6]]" >
      <li>{{mytime[6]}}</li>
      <li>产品集中交易系统<br/>初始化前流水归档<br/>(可与下两步并行操作)</li>
      <li>{{result[6]}}</li>
    </ul>

    <ul :class="[myclass[7]]" >
      <li>{{mytime[7]}}</li>
      <li>集中交易系统初始化前<br/>备份</li>
      <li>{{result[7]}}</li>
    </ul>
    <ul :class="[myclass[8]]" >
      <li>{{mytime[8]}}</li>
      <li> 系统初始化准备<br/>（第一步）(T+1日)</li>
      <li>{{result[8]}}</li>
    </ul>
    <ul :class="[myclass[9]]" >
      <li>{{mytime[9]}}</li>
      <li>交易系统初始化<br/>(第二步)(T+1日)报价</li>
      <li>{{result[9]}}</li>
    </ul>
    <ul :class="[myclass[10]]" >
      <li>{{mytime[10]}}</li>
      <li>报价全局初始化</li>
      <li>{{result[10]}}</li>
    </ul>
    <ul :class="[myclass[11]]" >
      <li>{{mytime[11]}}</li>
      <li>盯市系统初始化</li>
      <li>{{result[11]}}</li>
    </ul>

    <ul :class="[myclass[12]]" >
      <li>{{mytime[12]}}</li>
      <li>初始化后核心导出</li>
      <li>{{result[12]}}</li>
    </ul>

    <ul :class="[myclass[13]]" >
      <li>{{mytime[13]}}</li>
      <li>PT数据同步到VIP</li>
      <li>{{result[13]}}</li>
    </ul>
    <ul :class="[myclass[14]]" >
      <li>{{mytime[14]}}</li>
      <li>初始化后数据导出<br/>(T+1日)执行"定时导出"</li>
      <li>{{result[14]}}</li>
    </ul>
    <ul :class="[myclass[15]]" >
      <li>{{mytime[15]}}</li>
      <li>提醒外包检查所有核心<br/>总控数据导出</li>
      <li>{{result[15]}}</li>
    </ul>
    <ul :class="[myclass[16]]" >
      <li>{{mytime[16]}}</li>
      <li>资管63、66、69文件<br/>发送检查<br/>（机器：wjcl上opff）</li>
      <li>{{result[16]}}</li>
    </ul>
    <ul :class="[myclass[17]]" >
      <li>{{mytime[17]}}</li>
      <li>检查当前数据复制</li>
      <li>{{result[17]}}</li>
    </ul>
    <ul :class="[myclass[18]]" >
      <li>{{mytime[18]}}</li>
      <li>检查历史数据复制</li>
      <li>{{result[18]}}</li>
    </ul>
  </div>
</body>

<script type="text/javascript">


    var ve = new Vue({
        el: '#nightThird',
        data(){
    return {
      date:"",
      time:"",
      timer1:'',
      timer2:'',
      randomnum:[],
      randomnum2:[],
      randomnum3:[],
      myclass:[],
      result:[],
      mytime:[]
    }
  },
  created (){
    this.initData();
    this.formatTime();
    this.timer1 = setInterval(() => {
      this.formatTime();
    }, 1000);
    this.timer2 = setInterval(() => {
      // console.log(this.RandomNumBoth(100,999))
      this.getarr1()
    }, 1000);
    this.timer3 = setInterval(() => {
      this.startRun();
    }, 1000);
  },
  methods:{
    RandomNumBoth(Min,Max){
    var Range = Max - Min;
    var Rand = Math.random();
    var num = Min + Math.round(Rand * Range); //四舍五入
    return num;
    },
    getarr1(){
      this.randomnum=[]
      this.randomnum2=[]
      this.randomnum3=[]
      for (let index = 0; index < 22; index++) {
        this.randomnum.push(this.RandomNumBoth(100,999))
        this.randomnum2.push(this.RandomNumBoth(10000000,99999999))
        this.randomnum3.push(this.RandomNumBoth(75,100))
      }
    },
    formatTime() {
      let dd = "";
      let currentDate = new Date();
      let Dd = [
        "星期日",
        "星期一",
        "星期二",
        "星期三",
        "星期四",
        "星期五",
        "星期六"
      ];
      let Y = currentDate.getFullYear();
      let M = currentDate.getMonth() + 1;
      let D = currentDate.getDate();
      let d = currentDate.getDay();
      let h = currentDate.getHours();
      let m = currentDate.getMinutes();
      let s = currentDate.getSeconds();
      if (M < 10) {
        M = "0" + String(M);
      }
      if (D < 10) {
        D = "0" + String(D);
      }
      if (h < 10) {
        h = "0" + String(h);
      }
      if (m < 10) {
        m = "0" + String(m);
      }
      if (s < 10) {
        s = "0" + String(s);
      }
      if (d == 0) {
        dd = Dd[0];
      } else if (d == 1) {
        dd = Dd[1];
      } else if (d == 2) {
        dd = Dd[2];
      } else if (d == 3) {
        dd = Dd[3];
      } else if (d == 4) {
        dd = Dd[4];
      } else if (d == 5) {
        dd = Dd[5];
      } else if (d == 6) {
        dd = Dd[6];
      }
      this.date = Y+'-'+M+'-'+D;
      this.week = dd;
      this.time = h+':'+m+':'+s;
    },
    initData(){
      this.startTime = ["20:46:00-21:25:00","21:26:00-21:56:00","21:57:00-22:28:00","22:29:00-23:00:00","23:01:00-23:30:00","23:31:00-00:01:00",
                          "21:27:00-22:00:00","22:01:00-22:30:00","22:31:00-22:59:00","23:00:00-23:30:00","23:31:00-23:59:00","00:01:00-00:30:00",
                          "00:46:00-01:15:00","01:16:00-03:00:00","03:01:00-03:30:00","04:31:00-05:00:00","05:01:00-05:30:00","05:31:00-06:30:00",
                          "06:31:00-07:00:00"
                          ];
      this.warning_num = this.RandomNumBoth(0,18);
    },
    startRun(){
        this.startrun = "16:58:00";
        for(let j = 0;j < 19; j++){
          this.myclass[j] = "i_"+j;
          this.result[j] =  "未执行";
          this.mytime[j] = this.time;
        }
        //这里只有17点以后才能23:59:59秒以前才能进来
        if(this.time > this.startrun){
            for(let i = 0; i < 19; i++){
              let curT = this.startTime[i].split("-")[0];
              if(curT >= "00:01:00" && curT <="07:00:00"){
                  return;
              }
              //当天
              if(this.time >= curT){
                  this.switchClass(i);
              }
            }
        }else if(this.time >= "00:00:00" && this.time <= "07:00:00"){
            //这里跨天了
            for(let i = 0; i < 19; i++){
                let curT = this.startTime[i].split("-")[0];
                if(curT >= "00:01:00" && curT <="07:00:00"){
                    if(this.time >= curT){
                        this.switchClass(i);
                    }
                }else{
                    this.switchClass(i);
                }
            }
        }
    },
    switchClass(i){
      if(i == this.warning_num){
        this.myclass[i] = "w_"+i;
        this.result[i] = "告警";
        this.mytime[i] = this.startTime[i].split("-")[0];
      }else{
        this.myclass[i] = "f_"+i;
        this.result[i] = "已完成";
        this.mytime[i] = this.startTime[i].split("-")[0];
      }
    }

  },
  destroyed() {
    clearInterval(this.timer1)
    clearInterval(this.timer2)
    clearInterval(this.timer3)
  }
});
</script>

</html>